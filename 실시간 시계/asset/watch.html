<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="common/default.css">
  <link rel="stylesheet" href="scss/watch.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <title>Document</title>
  <script src="https://cdn.polyfill.io/v2/polyfill.min.js"></script>

</head>

<body>
  <div class="wrap">
    <div class="watch watch__container watch-style-v1">
      <div class="watch__inner watch__inner-style">
        <header>
          <span id="rec"></span>
          <ul class="header">
            <li class="header__list  header__title header__title-v1">
              디지털
            </li>
            <li class="header__list header__date header__title-v1" id="dateNow">

            </li>
          </ul>
        </header>
        <section class="main">
          <div class="showBox">
            <!-- time -->
            <div id="timeView" class="watch__main watch__main-style-v1">
              <p id="time" class="time-style"></p>
            </div>

            <!-- lab -->
            <div id="labView" class="lab__main watch__main-style-v1">
              <p id="lab" class="lab-style">
                <span id="min">00</span>:<span id="seconds">00</span>:<span id="tens">00</span>
              </p>
            </div>
          </div>
          <div class="labBox" id="labBoxId">
            <ul>
              <li id="labBox__left">
              </li>
              <li id="labBox__right">
              </li>
            </ul>
          </div>
        </section>
        <footer>
          <div class="watch__controler">
            <div class="resetCont changeClose" id="resetBt">
              reset
            </div>
            <div class="controlder_lumi" id="luminous">
              <button type="button" class="lumiBt"></button>
            </div>
            <ul class="watch__controler-cont">
              <li class="controler__bt-v1" id="timeBt" data-name="noneLabFun">
                <button type="button" class="controler__bt button-v1" id="analogbutton" data-name="analog">아날로그</button>
              </li>
              <li id="labBt" class="controler__bt-v1" data-start="start">
                <button type="button" class="controler__bt button-v2" id="stopbutton">스톱워치</button>
              </li>
              <li id="outButton" class="controler__bt-v1 changeClose" data-start="out">
                <button type="button" class="controler__bt button-v1">종료</button>
              </li>
            </ul>
          </div>
        </footer>
      </div>
    </div>
  </div>

  <div id="server">
    <p>나 서버</p>

  </div>
  <script>
    window.addEventListener('DOMContentLoaded', function () {
      setInterval(function () {
        let time = document.getElementById('time');
        let titleDay = document.getElementById('dateNow');
        let date = new Date();
        let year = String(date.getFullYear());
        let mon = String(date.getMonth() + 1);
        let day = String(date.getDate());

        let hour = String(date.getHours());
        let min = String(date.getMinutes());
        let sec = String(date.getSeconds());
        (hour.length == 1) ? hour = '0' + hour: hour;
        (min.length == 1) ? min = '0' + min: min;
        (sec.length == 1) ? sec = '0' + sec: sec;

        (year.length == 1) ? year = '0' + year: year;
        (mon.length == 1) ? mon = '0' + mon: mon;
        (day.length == 1) ? day = '0' + day: day;

        let customYear = year.substr(2, 2);
        let timeNow = hour + ':' + min + ':' + sec;
        let dateNow = customYear + '-' + mon + '-' + day;

        time.innerText = timeNow;
        titleDay.innerText = dateNow;

      }, 1000);


      let timeBt = document.getElementById('timeBt');
      let labBt = document.getElementById('labBt');
      let timeView = document.getElementById('timeView');
      let labView = document.getElementById('labView');
      let analogbutton = document.getElementById('analogbutton');
      let stopbutton = document.getElementById('stopbutton');
      let lab = document.getElementById('lab');
      let resetBt = document.getElementById('resetBt');
      let outButton = document.getElementById('outButton');
      let labBoxId =document.getElementById('labBoxId');

      let buttonList = document.querySelectorAll('.watch__controler-cont li');
      console.log(buttonList);

      function activeBt() {
        for (var i = 0; i < buttonList.length; i++) {
          buttonList[i].style.width = "30%";
        }
      }
      function noneActivBt() {
        for (var i = 0; i < buttonList.length; i++) {
          buttonList[i].style.width = "47%";
        }
      }

      labBt.addEventListener('click', function (e) {

        if (labBt.getAttribute('data-start') == "start") {
          labBt.firstElementChild.textContent = '시작';
          labBt.classList.add('stopColor');
          labBt.setAttribute('data-start', "stop");
          stopbutton.classList.add('ft-Wt');
          analogbutton.setAttribute('data-name', 'unact');
          analogbutton.textContent = "랩";
          timeView.classList.add('changeClose');
          labView.classList.add('changeView');
          timeBt.setAttribute('data-name','actLabFun'); // labBt act
          labBoxId.classList.add('changeView');

          setTimeout(() => {
            outButton.classList.add('changeView');
            resetBt.classList.add('changeView');
          }, 500);
          activeBt();
        } else if (labBt.getAttribute('data-start') == "stop") {
          labBt.firstElementChild.textContent = '정지';
          labBt.setAttribute('data-start', "restart");
          analogbutton.setAttribute('data-name', 'unact');
          analogbutton.textContent = "랩";

          Interval = setInterval(startTimer, 10); //timer start

        } else if (labBt.getAttribute('data-start') == "restart") {
          labBt.firstElementChild.textContent = '재시작';
          labBt.setAttribute('data-start', "stop");
          analogbutton.setAttribute('data-name', 'unact');
          analogbutton.textContent = "랩";

          clearInterval(Interval); //timer stop

        } else {

        }
      })

      resetBt.addEventListener('click', function () {
        (tens>1)?clearInterval(Interval):false;
 
        tens = "00";
        seconds = "00";
        minit = "00";
        labTens.innerHTML = tens;
        labSec.innerHTML = seconds;
        labMin.innerHTML = minit;
        labBt.firstElementChild.textContent = '시작';
        labBt.setAttribute('data-start', "stop");
          stopbutton.classList.add('ft-Wt');
          analogbutton.setAttribute('data-name', 'unact');
          labBox__left.innerHTML="";
          labNumber =0;
      })
     
      outButton.addEventListener('click', function () {
        labBt.setAttribute('data-start','start');
        timeView.classList.remove('changeClose');
        labView.classList.remove('changeView');
        outButton.classList.remove('changeView');
        resetBt.classList.remove('changeView');
        labBt.firstElementChild.textContent = '스톱워치';
        labBt.classList.remove('stopColor');
        analogbutton.textContent='아날로그';
        analogbutton.setAttribute('data-name','analog');
        timeBt.setAttribute('data-name',"noneLabFun");
        labBoxId.classList.remove('changeView');
        labBox__left.innerHTML='';
        labNumber =0;

        noneActivBt();
        (tens>1)?clearInterval(Interval):false;
        
        tens = "00";
        seconds = "00";
        minit = "00";
        labTens.innerHTML = tens;
        labSec.innerHTML = seconds;
        labMin.innerHTML = minit;

      })

      let labMin = document.getElementById('min');
      let labSec = document.getElementById('seconds');
      let labTens = document.getElementById('tens');
      var minit = 00;
      var seconds = 00;
      var tens = 00;

      function startTimer() {
        tens++;
        if (tens < 9) {
          labTens.innerHTML = "0" + tens;
        }
        if (tens > 9) {
          labTens.innerHTML = tens;
        }
        if (tens > 99) {
          seconds++;
          labSec.innerHTML = "0" + seconds;
          tens = 0;
          labTens.innerHTML = "0" + 0;
        }
        if (seconds > 9) {
          labSec.innerHTML = seconds;
        }
        if (seconds > 59) {
          minit++;
          labMin.innerText = "0" + minit;
          seconds = 0;
          seconds.innerHTML = "+" + 0;
        }
        if (minit > 9) {
          labMin.innerText = minit;
        }


      }

        let labBox__left =document.getElementById('labBox__left');
        let labBox__right =document.getElementById('labBox__right');
        let labNumber =0;
        let server = document.getElementById('server')

      timeBt.addEventListener('click', function () {
        if (analogbutton.getAttribute('data-name') == "analog") {
          analogbutton.textContent = "디지털";
          analogbutton.setAttribute('data-name', 'digital');

        } else if (analogbutton.getAttribute('data-name') == "digital") {
          timeBt.firstElementChild.textContent = '아날로그';
          analogbutton.setAttribute('data-name', 'analog');
        };

        // lab active
        if(timeBt.getAttribute('data-name')=="actLabFun"){
          labNumber++
          (tens<1)?labNumber=0:false;
          
          (labNumber<10)? labNumber= "0"+labNumber:labNumber=labNumber;
          let labRank = document.createElement('p');
          let labTool = '랩 '+labNumber+' '+labMin.textContent+":"+labSec.textContent+":"+labTens.textContent;
          labRank.innerText=labTool;
          (tens>1)?labBox__left.prepend(labRank):false;
          console.log(labNumber);

          if(labBox__left.childElementCount > 10){
            labBox__left.style.height="190px";
            labBox__left.style.overflow="hidden";
            let labBoxlastChild =labBox__left.lastElementChild;
            server.prepend(labBoxlastChild);
            console.log(labBoxlastChild);
          console.log('no');
            

        }

        }
      })

      

      let luminous = document.getElementById('luminous');
      luminous.addEventListener('click', function () {
        document.body.classList.toggle('luminousMode');
        this.classList.toggle('luminousBt');

        let rec = document.getElementById('rec');
        rec.classList.toggle('lightBet');
      })


    })
  </script>
</body>

</html>